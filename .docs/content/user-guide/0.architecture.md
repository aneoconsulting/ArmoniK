# Architecture overview

## Composable framework

```mermaid

flowchart TB
    subgraph TOP[" "]
        direction LR
        Queue["fa:fa-tasks<br/>Queue System"]
        ObjectStorage["fa:fa-database<br/>Object Storage"]
        Mongo["fa:fa-leaf<br/>MongoDB"]
        IAM["fa:fa-shield<br/>IAM"]
        Logging["fa:fa-file-text<br/>Logging System"]
    end

    ADS["ArmoniK<br/>Distributed Scheduler"]

    subgraph BOTTOM[" "]
        direction LR
        AutoScaler["fa:fa-arrows-alt<br/>AutoScaler"]
        ResourceAllocator["fa:fa-microchip<br/>Resource Allocator"]
    end

    Admin["fa:fa-user-plus<br/>Admin Client"]
    ComputeClient["fa:fa-user<br/>Compute Client"]
    ComputeLib["fa:fa-code<br/>Compute Library"]

    Queue === ADS
    ObjectStorage === ADS
    Mongo === ADS
    IAM === ADS
    Logging === ADS

    ADS === AutoScaler
    ADS === ResourceAllocator

    Admin ==> ADS
    ComputeClient ==> ADS
    ADS ==> ComputeLib

    style ADS fill:#ff5a00,color:#ffffff,stroke:#ff5a00,font-size:18px
    style TOP fill:transparent,stroke:transparent
    style BOTTOM fill:transparent,stroke:transparent

    linkStyle default stroke-width:4px
```

|Deployment type| Queue system | Object Storage | IAM | Logging System | Autoscaler | Resource Allocator |
|---|---|---|---|---|---|---|
Vanilla Kubernetes | ActiveMQ | MinIO | IAM | Logging System | KEDA | Kubernetes
Amazon Web Services | SQS | S3 | AWS IAM | Cloud Watch | KEDA | EKS
Google Cloud Platform | PubSub | GCS | GCP IAM | Cloud Monitoring | KEDA | GKS


<!--

## Vanilla Kubernetes deployment

```mermaid

flowchart TB
    subgraph TOP[" "]
        direction LR
        Queue["fa:fa-tasks<br/>ActiveMQ"]
        ObjectStorage["fa:fa-database<br/>MinIO"]
        Mongo["fa:fa-leaf<br/>MongoDB"]
        IAM["fa:fa-shield<br/>IAM"]
        Logging["fa:fa-file-text<br/>Logging System"]
    end

    ADS["ArmoniK<br/>Distributed Scheduler"]

    subgraph BOTTOM[" "]
        direction LR
        AutoScaler["fa:fa-arrows-alt<br/>KEDA"]
        ResourceAllocator["fa:fa-cubes<br/>Kubernetes"]
    end

    Admin["fa:fa-user-plus<br/>Admin Client"]
    ComputeClient["fa:fa-user<br/>Compute Client"]
    ComputeLib["fa:fa-code<br/>Compute Library"]

    Queue === ADS
    ObjectStorage === ADS
    Mongo === ADS
    IAM === ADS
    Logging === ADS

    ADS === AutoScaler
    ADS === ResourceAllocator

    Admin ==> ADS
    ComputeClient ==> ADS
    ADS ==> ComputeLib

    style ADS fill:#ff5a00,color:#ffffff,stroke:#ff5a00,font-size:18px
    style TOP fill:transparent,stroke:transparent
    style BOTTOM fill:transparent,stroke:transparent

    linkStyle default stroke-width:4px
```

## Designed for cloud integration: AWS deployment example

```mermaid

flowchart TB
    subgraph TOP[" "]
        direction LR
        Queue["fa:fa-tasks<br/>SQS"]
        ObjectStorage["fa:fa-database<br/>AWS S3"]
        Mongo["fa:fa-leaf<br/>MongoDB"]
        IAM["fa:fa-shield<br/>AWS IAM"]
        Logging["fa:fa-file-text<br/>Cloud Watch"]
    end

    ADS["ArmoniK<br/>Distributed Scheduler"]

    subgraph BOTTOM[" "]
        direction LR
        AutoScaler["fa:fa-arrows-alt<br/>KEDA"]
        ResourceAllocator["fa:fa-cubes<br/>Elastic Kubernetes Service"]
    end

    Admin["fa:fa-user-plus<br/>Admin Client"]
    ComputeClient["fa:fa-user<br/>Compute Client"]
    ComputeLib["fa:fa-code<br/>Compute Library"]

    Queue === ADS
    ObjectStorage === ADS
    Mongo === ADS
    IAM === ADS
    Logging === ADS

    ADS === AutoScaler
    ADS === ResourceAllocator

    Admin ==> ADS
    ComputeClient ==> ADS
    ADS ==> ComputeLib

    style ADS fill:#ff5a00,color:#ffffff,stroke:#ff5a00,font-size:18px
    style TOP fill:transparent,stroke:transparent
    style BOTTOM fill:transparent,stroke:transparent

    linkStyle default stroke-width:4px
```
-->

## High level architecture

![Armonik core diagram](https://armonik-public-images.s3.eu-west-3.amazonaws.com/deployment-doc/armonik-core-architecture.png)

### 1. Compute Plane
- **Purpose:** The Compute Plane is responsible for executing the main computational workloads.
- **Instances:** 
  - **Agent:** Manages and orchestrates tasks within the Compute Plane.
  - **Worker:** Executes the actual workloads or tasks assigned by the Agent.

#### **Partitions**
- The Compute Plane may consist of multiple partitions, for a detailed discussion see the [partitioning guide](./2.how-to-configure-partitions.md/#what-partitioning-means-in-armonik). 

### 2. Control Plane
- **Purpose:** The Control Plane oversees the entire system, managing workload submission, logging, and performance metrics.
  
#### **Key Components:**
- **Submitter:** Responsible for submitting workloads to the Compute Plane.
- **Logs:** Captures event logs for monitoring and debugging.
- **Metrics:** Collects performance metrics to analyze system efficiency and resource usage.


### 3. Storage (Data Plane)
- **Purpose:** Storage handles data management, ensuring that workloads have access to necessary data.

#### **Storage Types:**
- **Queue:** Used for managing task submissions and ensuring tasks are executed in a controlled manner.
- **Object Storage:** Manages files and objects that may be needed during computation (Inputs/Outputs).
- **Database:** Stores task's  meta data, potentially for persistent storage of results or job state.

## Architecture internals

![Armonik overview diagram](https://armonik-public-images.s3.eu-west-3.amazonaws.com/deployment-doc/architecture-ArmoniK-internals.svg)

